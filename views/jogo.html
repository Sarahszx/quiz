<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quiz de L√≥gica</title>
  <link rel="stylesheet" href="../styles/jogo.css" />
  <link rel="icon" href="../imagem/favicon.png" />
</head>
<body>

  <a href="../index.html" class="voltar-menu">&#8592;</a>

  <div id="login-container">
    <h2>Informe seu nome</h2>
    <input type="text" id="nome" placeholder="Nome de usu√°rio">
    <button id="btn-iniciar">Iniciar Quiz</button>
  </div>

  <div class="cronometro" style="display:none;">
    ‚è±Ô∏è <span id="tempo">00:30</span>
  </div>

  <div class="quiz-container" style="display:none;">
    <div class="quiz-header">
      <h1>Pergunta 1 de 10</h1>
    </div>
    <div class="quiz-body">
      <h2 id="pergunta"></h2>
      <div class="op√ß√µes" id="opcoes"></div>
      <button class="bot√£o-avan√ßar" disabled>Pr√≥xima</button>
    </div>
  </div>

  <div class="pontuacao-container" style="display:none;">
    <div class="pontuacao-header">
      <h2>Pontua√ß√£o</h2>
    </div>

    <div class="pontuacao-body">
      <div class="linha">
        <span class="categoria">F√°ceis</span>
        <span class="resultado">Obteve <strong id="pontos-faceis">0P</strong></span>
      </div>
      <hr>
      <div class="linha">
        <span class="categoria">M√©dias</span>
        <span class="resultado">Obteve <strong id="pontos-medias">0P</strong></span>
      </div>
      <hr>
      <div class="linha">
        <span class="categoria">Dif√≠ceis</span>
        <span class="resultado">Obteve <strong id="pontos-dificeis">0P</strong></span>
      </div>
    </div>

    <div class="pontuacao-footer">
      <button id="btn-ranking">Ir para Ranking</button>
    </div>
  </div>

  <div class="ranking-container" style="display:none;">
    <div class="ranking-header">üëë Top 10</div>
    <div class="ranking-body">
      <div class="ranking-coluna">
        <div class="ranking-item">ü•á1. Fulano</div>
        <div class="ranking-item">ü•à2. Fulano</div>
        <div class="ranking-item">ü•â3. Fulano</div>
        <div class="ranking-item">üèÖ4. Fulano</div>
        <div class="ranking-item">üèÖ5. Fulano</div>
      </div>
      <div class="ranking-coluna">
        <div class="ranking-item">üèÖ6. Fulano</div>
        <div class="ranking-item">üèÖ7. Fulano</div>
        <div class="ranking-item">üèÖ8. Fulano</div>
        <div class="ranking-item">üèÖ9. Fulano</div>
        <div class="ranking-item">üèÖ10. Fulano</div>
      </div>
    </div>
  </div>

<script>
const loginContainer = document.getElementById("login-container");
const quizContainer = document.querySelector(".quiz-container");
const cronometroDiv = document.querySelector(".cronometro");
const pontuacaoContainer = document.querySelector(".pontuacao-container");
const rankingContainer = document.querySelector(".ranking-container");

const pontosFacil = document.getElementById("pontos-faceis");
const pontosMedia = document.getElementById("pontos-medias");
const pontosDificil = document.getElementById("pontos-dificeis");

let nomeUsuario;

function mostrarQuiz() {
  loginContainer.style.display = "none";
  quizContainer.style.display = "block";
  cronometroDiv.style.display = "block";
  carregarPerguntaAleatoria();
}

window.onload = function() {
  const nome = localStorage.getItem("nomeUsuario");
  if (nome) mostrarQuiz();
};

// LOGIN SEM SENHA
document.getElementById("btn-iniciar").onclick = function() {
  let nome = document.getElementById("nome").value.trim().toUpperCase();
  if (nome === "") return alert("Por favor, informe um nome de usu√°rio.");

  // Verifica se j√° existe no localStorage
  if (localStorage.getItem(nome)) {
    return alert("Nome de usu√°rio j√° existe! Escolha outro.");
  }

  // Salva o nome e inicia o quiz
  localStorage.setItem("nomeUsuario", nome);
  mostrarQuiz();
};

// PERGUNTAS
const perguntas = [
  {
    pergunta: "Qual √© a fun√ß√£o da tag <title> em um documento HTML?",
    opcoes: ["Exibir o t√≠tulo no corpo da p√°gina", "Definir o t√≠tulo que aparece na aba do navegador", "Adicionar uma legenda a uma imagem", "Criar um cabe√ßalho vis√≠vel na pagina"],
    resposta: "b",
    categoria: "facil"
  },
  {
    pergunta: "Como se aplica uma cor de fundo azul a uma p√°gina com CSS?",
    opcoes: ["background-color: red;", "color: blue;", "bgcolor: blue;", "background-color: blue;"],
    resposta: "d",
    categoria: "facil"
  },
  {
    pergunta: "Qual √© o operador usado para atribui√ß√£o de valor em JavaScript?",
    opcoes: ["=", "==", "===", "=>"],
    resposta: "a",
    categoria: "facil"
  },
  {
    pergunta: "Qual propriedade CSS √© usada para criar espa√ßamento entre elementos (por fora)?",
    opcoes: ["padding", "spacing", "margin", "border"],
    resposta: "c",
    categoria: "media"
  },
  {
    pergunta: "O que a fun√ß√£o Math.floor(5.9) retorna?",
    opcoes: ["5.9", "6", "5", "Erro"],
    resposta: "c",
    categoria: "media"
  },
  {
    pergunta: "Qual dessas estruturas √© usada para repetir um bloco de c√≥digo enquanto uma condi√ß√£o for verdadeira?",
    opcoes: ["for", "if", "switch", "while"],
    resposta: "d",
    categoria: "media"
  },
  {
    pergunta: "O que diferencia TypeScript do JavaScript?",
    opcoes: ["TypeScript permite tipagem est√°tica", "TypeScript n√£o funciona em navegadores", "TypeScript √© mais r√°pido", "TypeScript √© usado apenas para back-end"],
    resposta: "a",
    categoria: "media"
  },
  {
    pergunta: "Como centralizar um texto horizontalmente dentro de uma div com CSS?",
    opcoes: ["text-align: left;", "justify-content: center;", "text-align: center;", "align-items: center;"],
    resposta: "c",
    categoria: "media"
  },
  {
    pergunta: "Qual a principal vantagem da tipagem est√°tica em TypeScript?",
    opcoes: ["Facilita a edi√ß√£o de imagens", "Permite que o c√≥digo rode mais devagar", "Evita muitos erros em tempo de execu√ß√£o ao detectar problemas antes de rodar o programa", "Substitui a necessidade de JavaScript"],
    resposta: "c",
    categoria: "dificil"
  },
  {
    pergunta: "Em JavaScript, o que √© closure?",
    opcoes: ["√â uma fun√ß√£o que lembra do escopo onde foi criada, mesmo ap√≥s esse escopo ter sido finalizado", "√â um erro que ocorre quando uma fun√ß√£o n√£o retorna nada", "√â uma t√©cnica usada para fechar conex√µes com o banco de dados", "√â o mesmo que uma fun√ß√£o recursiva"],
    resposta: "a",
    categoria: "dificil"
  }
];

const letras = ['a', 'b', 'c', 'd'];
const pontosFacilCategoria = 1;
const pontosMediaCategoria = 2;
const pontosDificilCategoria = 3;

let perguntaAtual;
let tempoRestante = 30;
let cronometro;
let respondeu = false;
let indicePergunta = 0;
let pontuacaoFacil = 0;
let pontuacaoMedia = 0;
let pontuacaoDificil = 0;

const perguntasEmbaralhadas = [...perguntas].sort(() => Math.random() - 0.5);

const perguntaH2 = document.getElementById("pergunta");
const opcoesDiv = document.getElementById("opcoes");
const botaoAvancar = document.querySelector(".bot√£o-avan√ßar");
const tempoSpan = document.getElementById("tempo");

function atualizarTempo() {
  tempoSpan.textContent = "00:" + (tempoRestante < 10 ? "0" : "") + tempoRestante;
}

function iniciarCronometro() {
  clearInterval(cronometro);
  tempoRestante = 30;
  atualizarTempo();
  cronometro = setInterval(function() {
    tempoRestante--;
    atualizarTempo();
    if (tempoRestante <= 0) {
      clearInterval(cronometro);
      if (!respondeu) encerrarTempo();
    }
  }, 1000);
}

function encerrarTempo() {
  document.querySelectorAll(".op√ß√£o").forEach(btn => btn.disabled = true);
  mostrarCorreta();
  botaoAvancar.disabled = false;
}

function mostrarCorreta() {
  document.querySelectorAll(".op√ß√£o").forEach(btn => {
    if (btn.dataset.letra === perguntaAtual.resposta) btn.classList.add("correta");
  });
}

function carregarPerguntaAleatoria() {
  if (indicePergunta >= 10) return;
  perguntaAtual = perguntasEmbaralhadas[indicePergunta];
  perguntaH2.innerText = perguntaAtual.pergunta;
  document.querySelector(".quiz-header h1").innerText = "Pergunta " + (indicePergunta + 1) + " de 10";
  botaoAvancar.disabled = true;
  respondeu = false;
  opcoesDiv.innerHTML = "";
  for (let i = 0; i < letras.length; i++) {
    const btn = document.createElement("button");
    btn.classList.add("op√ß√£o");
    btn.dataset.letra = letras[i];
    btn.innerHTML = letras[i] + ") " + perguntaAtual.opcoes[i].toLowerCase();
    btn.onclick = function() {
      if (respondeu) return;
      if (btn.dataset.letra === perguntaAtual.resposta) {
        btn.classList.add("correta");
        if (perguntaAtual.categoria === 'facil') pontuacaoFacil += pontosFacilCategoria;
        if (perguntaAtual.categoria === 'media') pontuacaoMedia += pontosMediaCategoria;
        if (perguntaAtual.categoria === 'dificil') pontuacaoDificil += pontosDificilCategoria;
      } else {
        btn.classList.add("errada");
        mostrarCorreta();
      }
      respondeu = true;
      clearInterval(cronometro);
      encerrarTempo();
    };
    opcoesDiv.appendChild(btn);
  }
  iniciarCronometro();
}

botaoAvancar.onclick = function() {
  indicePergunta++;
  if (indicePergunta === 10) {
    pontuacaoContainer.style.display = "block";
    pontosFacil.innerText = pontuacaoFacil + "P";
    pontosMedia.innerText = pontuacaoMedia + "P";
    pontosDificil.innerText = pontuacaoDificil + "P";
    quizContainer.style.display = "none";
    cronometroDiv.style.display = "none";
  } else {
    carregarPerguntaAleatoria();
  }
};

const btnRanking = document.getElementById("btn-ranking");
btnRanking.onclick = function() {
  pontuacaoContainer.style.display = "none";
  rankingContainer.style.display = "block";
};
</script>

</body>
</html>
